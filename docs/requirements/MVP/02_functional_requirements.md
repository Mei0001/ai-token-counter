# 機能要件

## 1. トークン計算機能

### 1.1 テキスト入力
- **要件ID**: FR-001
- **説明**: ユーザーがテキストを入力できるテキストエリアを提供
- **詳細**:
  - 複数行のテキスト入力に対応
  - コピー＆ペーストに対応
  - 文字数制限：100,000文字（暫定）
  - リアルタイム入力対応

### 1.2 プロバイダー・モデル選択
- **要件ID**: FR-002
- **説明**: 対応するLLMプロバイダーとモデルを選択
- **詳細**:
  - OpenAI:
    - GPT-3.5-turbo
    - GPT-4
    - GPT-4-turbo
    - GPT-4o
    - GPT-4o-mini
  - Google:
    - Gemini Pro
    - Gemini Flash
  - Anthropic:
    - Claude 3 Haiku
    - Claude 3 Sonnet
    - Claude 3 Opus
    - Claude 3.5 Sonnet

### 1.3 トークン数計算
- **要件ID**: FR-003
- **説明**: 選択したモデルに応じた正確なトークン数を計算
- **詳細**:
  - 各プロバイダーの公式トークナイザーを使用
  - 入力トークン数の計算
  - 出力トークン数の推定（入力の50%として仮定）
  - 思考トークン数の推定（入力の5%として仮定）

### 1.4 文字数・ワード数表示
- **要件ID**: FR-004
- **説明**: 入力テキストの基本的な統計情報を表示
- **詳細**:
  - 総文字数（スペース含む/含まない）
  - ワード数（言語に応じた適切な分割）
  - 行数

## 2. 料金計算機能

### 2.1 料金計算
- **要件ID**: FR-005
- **説明**: トークン数に基づく使用料金を計算
- **詳細**:
  - 入力トークン料金
  - 出力トークン料金
  - 思考トークン料金（対応モデルのみ）
  - 合計料金

### 2.2 通貨表示
- **要件ID**: FR-006
- **説明**: 日本円（JPY）と米ドル（USD）での料金表示
- **詳細**:
  - デフォルト：日本円表示
  - 切り替えボタンで米ドル表示
  - 両方同時表示オプション

### 2.3 為替レート取得
- **要件ID**: FR-007
- **説明**: リアルタイムの為替レートを取得
- **詳細**:
  - 外部APIから為替レート取得
  - 更新頻度：ページロード時および手動更新ボタン
  - 取得失敗時は固定レート使用（1ドル=150円）

## 3. UI機能

### 3.1 リアルタイム更新
- **要件ID**: FR-008
- **説明**: テキスト入力時にリアルタイムで計算結果を更新
- **詳細**:
  - デバウンス処理（500ms）
  - プログレスインジケーター表示

### 3.2 比較表示
- **要件ID**: FR-009
- **説明**: 複数モデルの同時比較
- **詳細**:
  - 最大3モデルまで同時表示
  - 比較テーブル形式での表示

### 3.3 料金情報更新
- **要件ID**: FR-010
- **説明**: 各モデルの料金情報の管理
- **詳細**:
  - 管理者用の料金更新インターフェース（Phase 2）
  - 現在は設定ファイルでの管理

## 4. データ管理

### 4.1 プライバシー保護
- **要件ID**: FR-011
- **説明**: 入力テキストを保存しない
- **詳細**:
  - セッション終了時にメモリからクリア
  - ローカルストレージ使用なし
  - サーバーへの送信なし（トークナイザー処理を除く）